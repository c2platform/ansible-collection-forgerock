{{ ansible_managed|comment(decoration="// ") }}
{{ item|c2platform.forgerock.amster_script_header|comment(decoration="// ") }}
connect {{ amster_am_connect|c2platform.forgerock.ds_cmd }} {{ amster_am_install['serverUrl'] }}
{{ am_amster_common_functions }}
try {
{{ lookup('template', './params.groovy.j2')|indent(2, True) }}
   BODY="""{
      "amconfig.header.installdir": {
      "com.iplanet.am.locale": "$locale"}}""";
   cur_prop = eval("read DefaultGeneralProperties --global --body '$BODY'")
   if(isNull(eval("update DefaultGeneralProperties --global --body '$BODY'"))){
      println red("{{ am_amster_stdout_tags['error'] }} in settings the properties.")
   } else {
     println green("Setting the default locale was successful.")
   }
   new_prop = eval("read DefaultGeneralProperties --global --body '$BODY'")
   if (resourceChange(cur_prop, new_prop, true)) {
      println green("{{ am_amster_stdout_tags['changed'] }} in settings the properties.")
   }
} catch(Exception e) {
   println("{{ am_amster_stdout_tags['error'] }} ${e.getMessage()} ")
}
:quit
